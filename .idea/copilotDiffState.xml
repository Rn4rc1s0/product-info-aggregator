<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/application/dto/ProductInfoRequest.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/application/dto/ProductInfoRequest.java" />
              <option name="updatedContent" value="package com.kramp.productinfo.application.dto;&#10;&#10;import jakarta.validation.constraints.NotBlank;&#10;import jakarta.validation.constraints.Pattern;&#10;&#10;public record ProductInfoRequest(&#10;        @NotBlank(message = &quot;Product ID is required&quot;)&#10;        String productId,&#10;&#10;        @NotBlank(message = &quot;Market code is required&quot;)&#10;        @Pattern(regexp = &quot;^[a-z]{2}-[A-Z]{2}$&quot;, message = &quot;Market code must be in format: xx-XX (e.g., nl-NL, de-DE)&quot;)&#10;        String market,&#10;&#10;        String customerId&#10;) {}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/application/dto/ProductInfoResponse.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/application/dto/ProductInfoResponse.java" />
              <option name="updatedContent" value="package com.kramp.productinfo.application.dto;&#10;&#10;import com.kramp.productinfo.domain.model.ProductInfo;&#10;&#10;import java.math.BigDecimal;&#10;import java.time.LocalDate;&#10;import java.util.List;&#10;&#10;public record ProductInfoResponse(&#10;        String productId,&#10;        String market,&#10;        CatalogResponse catalog,&#10;        PricingResponse pricing,&#10;        AvailabilityResponse availability,&#10;        CustomerResponse customer,&#10;        List&lt;String&gt; warnings&#10;) {&#10;    public record CatalogResponse(&#10;            String name,&#10;            String description,&#10;            List&lt;String&gt; specifications,&#10;            List&lt;String&gt; imageUrls&#10;    ) {}&#10;&#10;    public record PricingResponse(&#10;            BigDecimal basePrice,&#10;            BigDecimal customerDiscount,&#10;            BigDecimal finalPrice,&#10;            String currency,&#10;            boolean available,&#10;            String message&#10;    ) {}&#10;&#10;    public record AvailabilityResponse(&#10;            Integer stockLevel,&#10;            String warehouseLocation,&#10;            LocalDate expectedDelivery,&#10;            boolean available,&#10;            String message&#10;    ) {}&#10;&#10;    public record CustomerResponse(&#10;            String segment,&#10;            List&lt;String&gt; preferences,&#10;            boolean personalized&#10;    ) {}&#10;&#10;    public static ProductInfoResponse fromDomain(ProductInfo productInfo, List&lt;String&gt; warnings) {&#10;        return new ProductInfoResponse(&#10;                productInfo.productId(),&#10;                productInfo.market(),&#10;                new CatalogResponse(&#10;                        productInfo.catalog().name(),&#10;                        productInfo.catalog().description(),&#10;                        productInfo.catalog().specifications(),&#10;                        productInfo.catalog().imageUrls()&#10;                ),&#10;                new PricingResponse(&#10;                        productInfo.pricing().basePrice(),&#10;                        productInfo.pricing().customerDiscount(),&#10;                        productInfo.pricing().finalPrice(),&#10;                        productInfo.pricing().currency(),&#10;                        productInfo.pricing().available(),&#10;                        productInfo.pricing().available() ? null : &quot;Price information unavailable&quot;&#10;                ),&#10;                new AvailabilityResponse(&#10;                        productInfo.availability().stockLevel(),&#10;                        productInfo.availability().warehouseLocation(),&#10;                        productInfo.availability().expectedDelivery(),&#10;                        productInfo.availability().available(),&#10;                        productInfo.availability().available() ? null : &quot;Stock information unknown&quot;&#10;                ),&#10;                new CustomerResponse(&#10;                        productInfo.customer().segment(),&#10;                        productInfo.customer().preferences(),&#10;                        productInfo.customer().personalized()&#10;                ),&#10;                warnings&#10;        );&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/controller/GlobalExceptionHandler.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/controller/GlobalExceptionHandler.java" />
              <option name="updatedContent" value="package com.kramp.productinfo.controller;&#10;&#10;import com.kramp.productinfo.domain.model.CatalogServiceException;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.validation.FieldError;&#10;import org.springframework.web.bind.MethodArgumentNotValidException;&#10;import org.springframework.web.bind.annotation.ExceptionHandler;&#10;import org.springframework.web.bind.annotation.RestControllerAdvice;&#10;&#10;import java.time.LocalDateTime;&#10;import java.util.HashMap;&#10;import java.util.Map;&#10;&#10;@RestControllerAdvice&#10;public class GlobalExceptionHandler {&#10;&#10;    @ExceptionHandler(CatalogServiceException.class)&#10;    public ResponseEntity&lt;ErrorResponse&gt; handleCatalogServiceException(CatalogServiceException ex) {&#10;        ErrorResponse error = new ErrorResponse(&#10;                HttpStatus.SERVICE_UNAVAILABLE.value(),&#10;                &quot;Catalog service unavailable - cannot display product without basic information&quot;,&#10;                ex.getMessage(),&#10;                LocalDateTime.now()&#10;        );&#10;        return ResponseEntity.status(HttpStatus.SERVICE_UNAVAILABLE).body(error);&#10;    }&#10;&#10;    @ExceptionHandler(MethodArgumentNotValidException.class)&#10;    public ResponseEntity&lt;Map&lt;String, Object&gt;&gt; handleValidationExceptions(MethodArgumentNotValidException ex) {&#10;        Map&lt;String, String&gt; errors = new HashMap&lt;&gt;();&#10;        ex.getBindingResult().getAllErrors().forEach((error) -&gt; {&#10;            String fieldName = ((FieldError) error).getField();&#10;            String errorMessage = error.getDefaultMessage();&#10;            errors.put(fieldName, errorMessage);&#10;        });&#10;&#10;        Map&lt;String, Object&gt; response = new HashMap&lt;&gt;();&#10;        response.put(&quot;status&quot;, HttpStatus.BAD_REQUEST.value());&#10;        response.put(&quot;error&quot;, &quot;Validation failed&quot;);&#10;        response.put(&quot;errors&quot;, errors);&#10;        response.put(&quot;timestamp&quot;, LocalDateTime.now());&#10;&#10;        return ResponseEntity.badRequest().body(response);&#10;    }&#10;&#10;    @ExceptionHandler(Exception.class)&#10;    public ResponseEntity&lt;ErrorResponse&gt; handleGenericException(Exception ex) {&#10;        ErrorResponse error = new ErrorResponse(&#10;                HttpStatus.INTERNAL_SERVER_ERROR.value(),&#10;                &quot;An unexpected error occurred&quot;,&#10;                ex.getMessage(),&#10;                LocalDateTime.now()&#10;        );&#10;        return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR).body(error);&#10;    }&#10;&#10;    public record ErrorResponse(&#10;            int status,&#10;            String error,&#10;            String message,&#10;            LocalDateTime timestamp&#10;    ) {}&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/domain/model/ProductInfo.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/domain/model/ProductInfo.java" />
              <option name="updatedContent" value="package com.kramp.productinfo.domain.model;&#10;&#10;import java.math.BigDecimal;&#10;import java.time.LocalDate;&#10;import java.util.List;&#10;&#10;public record ProductInfo(&#10;        String productId,&#10;        String market,&#10;        CatalogData catalog,&#10;        PricingData pricing,&#10;        AvailabilityData availability,&#10;        CustomerData customer&#10;) {&#10;    public record CatalogData(&#10;            String name,&#10;            String description,&#10;            List&lt;String&gt; specifications,&#10;            List&lt;String&gt; imageUrls&#10;    ) {}&#10;&#10;    public record PricingData(&#10;            BigDecimal basePrice,&#10;            BigDecimal customerDiscount,&#10;            BigDecimal finalPrice,&#10;            String currency,&#10;            boolean available&#10;    ) {&#10;        public static PricingData unavailable(String currency) {&#10;            return new PricingData(null, null, null, currency, false);&#10;        }&#10;    }&#10;&#10;    public record AvailabilityData(&#10;            Integer stockLevel,&#10;            String warehouseLocation,&#10;            LocalDate expectedDelivery,&#10;            boolean available&#10;    ) {&#10;        public static AvailabilityData unknown() {&#10;            return new AvailabilityData(null, null, null, false);&#10;        }&#10;    }&#10;&#10;    public record CustomerData(&#10;            String segment,&#10;            List&lt;String&gt; preferences,&#10;            boolean personalized&#10;    ) {&#10;        public static CustomerData standard() {&#10;            return new CustomerData(&quot;STANDARD&quot;, List.of(), false);&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/domain/ports/AvailabilityServicePort.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/domain/ports/AvailabilityServicePort.java" />
              <option name="updatedContent" value="package com.kramp.productinfo.domain.ports;&#10;&#10;import com.kramp.productinfo.domain.model.ProductInfo.AvailabilityData;&#10;&#10;public interface AvailabilityServicePort {&#10;    AvailabilityData getAvailabilityData(String productId, String market);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/domain/ports/CatalogServicePort.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/domain/ports/CatalogServicePort.java" />
              <option name="updatedContent" value="package com.kramp.productinfo.domain.ports;&#10;&#10;import com.kramp.productinfo.domain.model.ProductInfo.CatalogData;&#10;&#10;public interface CatalogServicePort {&#10;    CatalogData getCatalogData(String productId, String market);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/domain/ports/CustomerServicePort.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/domain/ports/CustomerServicePort.java" />
              <option name="updatedContent" value="package com.kramp.productinfo.domain.ports;&#10;&#10;import com.kramp.productinfo.domain.model.ProductInfo.CustomerData;&#10;&#10;public interface CustomerServicePort {&#10;    CustomerData getCustomerData(String customerId);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/domain/ports/PricingServicePort.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/domain/ports/PricingServicePort.java" />
              <option name="updatedContent" value="package com.kramp.productinfo.domain.ports;&#10;&#10;import com.kramp.productinfo.domain.model.ProductInfo.PricingData;&#10;&#10;public interface PricingServicePort {&#10;    PricingData getPricingData(String productId, String market, String customerId);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/infrastructure/MockAvailabilityService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/infrastructure/MockAvailabilityService.java" />
              <option name="updatedContent" value="package com.kramp.productinfo.infrastructure;&#10;&#10;import com.kramp.productinfo.domain.model.ProductInfo.AvailabilityData;&#10;import com.kramp.productinfo.domain.ports.AvailabilityServicePort;&#10;import org.slf4j.Logger;&#10;import org.slf4j.LoggerFactory;&#10;import org.springframework.stereotype.Component;&#10;&#10;import java.time.LocalDate;&#10;import java.util.Random;&#10;&#10;@Component&#10;public class MockAvailabilityService implements AvailabilityServicePort {&#10;&#10;    private static final Logger log = LoggerFactory.getLogger(MockAvailabilityService.class);&#10;    private static final Random random = new Random();&#10;    private static final double RELIABILITY = 0.98; // 98%&#10;    private static final int LATENCY_MS = 100;&#10;&#10;    @Override&#10;    public AvailabilityData getAvailabilityData(String productId, String market) {&#10;        simulateLatency();&#10;        simulateFailure();&#10;&#10;        log.debug(&quot;Mock: Fetching availability data for productId={}, market={}&quot;, productId, market);&#10;&#10;        int stockLevel = calculateStockLevel(productId);&#10;        String warehouse = getWarehouse(market);&#10;        LocalDate expectedDelivery = calculateDelivery(stockLevel);&#10;&#10;        AvailabilityData data = new AvailabilityData(stockLevel, warehouse, expectedDelivery, true);&#10;        log.debug(&quot;Mock: Returning availability data: stock={}, warehouse={}, delivery={}&quot;,&#10;                stockLevel, warehouse, expectedDelivery);&#10;        return data;&#10;    }&#10;&#10;    private int calculateStockLevel(String productId) {&#10;        // Generate deterministic stock based on productId&#10;        int hash = Math.abs(productId.hashCode());&#10;        return hash % 100; // Stock between 0 and 99&#10;    }&#10;&#10;    private String getWarehouse(String market) {&#10;        return switch (market.substring(0, 2).toLowerCase()) {&#10;            case &quot;nl&quot; -&gt; &quot;Amsterdam Warehouse&quot;;&#10;            case &quot;de&quot; -&gt; &quot;Hamburg Warehouse&quot;;&#10;            case &quot;pl&quot; -&gt; &quot;Warsaw Warehouse&quot;;&#10;            case &quot;fr&quot; -&gt; &quot;Paris Warehouse&quot;;&#10;            case &quot;it&quot; -&gt; &quot;Milan Warehouse&quot;;&#10;            case &quot;es&quot; -&gt; &quot;Madrid Warehouse&quot;;&#10;            case &quot;gb&quot; -&gt; &quot;London Warehouse&quot;;&#10;            case &quot;dk&quot; -&gt; &quot;Copenhagen Warehouse&quot;;&#10;            case &quot;se&quot; -&gt; &quot;Stockholm Warehouse&quot;;&#10;            default -&gt; &quot;Central European Warehouse&quot;;&#10;        };&#10;    }&#10;&#10;    private LocalDate calculateDelivery(int stockLevel) {&#10;        if (stockLevel &gt; 50) {&#10;            return LocalDate.now().plusDays(1); // Next day delivery&#10;        } else if (stockLevel &gt; 10) {&#10;            return LocalDate.now().plusDays(3); // 3 days&#10;        } else if (stockLevel &gt; 0) {&#10;            return LocalDate.now().plusDays(7); // 1 week&#10;        } else {&#10;            return LocalDate.now().plusDays(14); // 2 weeks (backorder)&#10;        }&#10;    }&#10;&#10;    private void simulateLatency() {&#10;        try {&#10;            Thread.sleep(LATENCY_MS);&#10;        } catch (InterruptedException e) {&#10;            Thread.currentThread().interrupt();&#10;        }&#10;    }&#10;&#10;    private void simulateFailure() {&#10;        if (random.nextDouble() &gt; RELIABILITY) {&#10;            log.warn(&quot;Mock: Simulating availability service failure&quot;);&#10;            throw new RuntimeException(&quot;Simulated availability service failure&quot;);&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/infrastructure/MockCatalogService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/infrastructure/MockCatalogService.java" />
              <option name="updatedContent" value="package com.kramp.productinfo.infrastructure;&#10;&#10;import com.kramp.productinfo.domain.model.ProductInfo.CatalogData;&#10;import com.kramp.productinfo.domain.ports.CatalogServicePort;&#10;import org.slf4j.Logger;&#10;import org.slf4j.LoggerFactory;&#10;import org.springframework.stereotype.Component;&#10;&#10;import java.util.List;&#10;import java.util.Map;&#10;import java.util.Random;&#10;&#10;@Component&#10;public class MockCatalogService implements CatalogServicePort {&#10;&#10;    private static final Logger log = LoggerFactory.getLogger(MockCatalogService.class);&#10;    private static final Random random = new Random();&#10;    private static final double RELIABILITY = 0.999; // 99.9%&#10;    private static final int LATENCY_MS = 50;&#10;&#10;    private static final Map&lt;String, Map&lt;String, CatalogData&gt;&gt; MOCK_DATA = Map.of(&#10;            &quot;PROD-001&quot;, Map.of(&#10;                    &quot;nl-NL&quot;, new CatalogData(&#10;                            &quot;Hydraulische pomp&quot;,&#10;                            &quot;Hoogwaardige hydraulische pomp voor tractoren&quot;,&#10;                            List.of(&quot;Capaciteit: 45 l/min&quot;, &quot;Druk: 250 bar&quot;, &quot;Gewicht: 12kg&quot;),&#10;                            List.of(&quot;https://example.com/img/pump-1.jpg&quot;, &quot;https://example.com/img/pump-2.jpg&quot;)&#10;                    ),&#10;                    &quot;de-DE&quot;, new CatalogData(&#10;                            &quot;Hydraulikpumpe&quot;,&#10;                            &quot;Hochwertige Hydraulikpumpe für Traktoren&quot;,&#10;                            List.of(&quot;Kapazität: 45 l/min&quot;, &quot;Druck: 250 bar&quot;, &quot;Gewicht: 12kg&quot;),&#10;                            List.of(&quot;https://example.com/img/pump-1.jpg&quot;, &quot;https://example.com/img/pump-2.jpg&quot;)&#10;                    ),&#10;                    &quot;pl-PL&quot;, new CatalogData(&#10;                            &quot;Pompa hydrauliczna&quot;,&#10;                            &quot;Wysokiej jakości pompa hydrauliczna do ciągników&quot;,&#10;                            List.of(&quot;Pojemność: 45 l/min&quot;, &quot;Ciśnienie: 250 bar&quot;, &quot;Waga: 12kg&quot;),&#10;                            List.of(&quot;https://example.com/img/pump-1.jpg&quot;, &quot;https://example.com/img/pump-2.jpg&quot;)&#10;                    )&#10;            ),&#10;            &quot;PROD-002&quot;, Map.of(&#10;                    &quot;nl-NL&quot;, new CatalogData(&#10;                            &quot;Luchtfilter&quot;,&#10;                            &quot;Premium luchtfilter voor landbouwmachines&quot;,&#10;                            List.of(&quot;Diameter: 150mm&quot;, &quot;Hoogte: 300mm&quot;, &quot;Efficiëntie: 99.8%&quot;),&#10;                            List.of(&quot;https://example.com/img/filter-1.jpg&quot;)&#10;                    ),&#10;                    &quot;de-DE&quot;, new CatalogData(&#10;                            &quot;Luftfilter&quot;,&#10;                            &quot;Premium Luftfilter für Landmaschinen&quot;,&#10;                            List.of(&quot;Durchmesser: 150mm&quot;, &quot;Höhe: 300mm&quot;, &quot;Effizienz: 99.8%&quot;),&#10;                            List.of(&quot;https://example.com/img/filter-1.jpg&quot;)&#10;                    ),&#10;                    &quot;pl-PL&quot;, new CatalogData(&#10;                            &quot;Filtr powietrza&quot;,&#10;                            &quot;Wysokiej jakości filtr powietrza do maszyn rolniczych&quot;,&#10;                            List.of(&quot;Średnica: 150mm&quot;, &quot;Wysokość: 300mm&quot;, &quot;Wydajność: 99.8%&quot;),&#10;                            List.of(&quot;https://example.com/img/filter-1.jpg&quot;)&#10;                    )&#10;            )&#10;    );&#10;&#10;    @Override&#10;    public CatalogData getCatalogData(String productId, String market) {&#10;        simulateLatency();&#10;        simulateFailure();&#10;&#10;        log.debug(&quot;Mock: Fetching catalog data for productId={}, market={}&quot;, productId, market);&#10;&#10;        Map&lt;String, CatalogData&gt; productData = MOCK_DATA.get(productId);&#10;        if (productData == null) {&#10;            // Default fallback for unknown products&#10;            return createDefaultCatalog(productId, market);&#10;        }&#10;&#10;        CatalogData data = productData.getOrDefault(market, productData.get(&quot;nl-NL&quot;));&#10;        log.debug(&quot;Mock: Returning catalog data: {}&quot;, data.name());&#10;        return data;&#10;    }&#10;&#10;    private CatalogData createDefaultCatalog(String productId, String market) {&#10;        return new CatalogData(&#10;                &quot;Product &quot; + productId,&#10;                &quot;Description for product &quot; + productId + &quot; in market &quot; + market,&#10;                List.of(&quot;Specification 1&quot;, &quot;Specification 2&quot;),&#10;                List.of(&quot;https://example.com/img/default.jpg&quot;)&#10;        );&#10;    }&#10;&#10;    private void simulateLatency() {&#10;        try {&#10;            Thread.sleep(LATENCY_MS);&#10;        } catch (InterruptedException e) {&#10;            Thread.currentThread().interrupt();&#10;        }&#10;    }&#10;&#10;    private void simulateFailure() {&#10;        if (random.nextDouble() &gt; RELIABILITY) {&#10;            log.warn(&quot;Mock: Simulating catalog service failure&quot;);&#10;            throw new RuntimeException(&quot;Simulated catalog service failure&quot;);&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/infrastructure/MockCustomerService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/infrastructure/MockCustomerService.java" />
              <option name="updatedContent" value="package com.kramp.productinfo.infrastructure;&#10;&#10;import com.kramp.productinfo.domain.model.ProductInfo.CustomerData;&#10;import com.kramp.productinfo.domain.ports.CustomerServicePort;&#10;import org.slf4j.Logger;&#10;import org.slf4j.LoggerFactory;&#10;import org.springframework.stereotype.Component;&#10;&#10;import java.util.List;&#10;import java.util.Random;&#10;&#10;@Component&#10;public class MockCustomerService implements CustomerServicePort {&#10;&#10;    private static final Logger log = LoggerFactory.getLogger(MockCustomerService.class);&#10;    private static final Random random = new Random();&#10;    private static final double RELIABILITY = 0.99; // 99%&#10;    private static final int LATENCY_MS = 60;&#10;&#10;    @Override&#10;    public CustomerData getCustomerData(String customerId) {&#10;        simulateLatency();&#10;        simulateFailure();&#10;&#10;        log.debug(&quot;Mock: Fetching customer data for customerId={}&quot;, customerId);&#10;&#10;        String segment = determineSegment(customerId);&#10;        List&lt;String&gt; preferences = determinePreferences(customerId);&#10;&#10;        CustomerData data = new CustomerData(segment, preferences, true);&#10;        log.debug(&quot;Mock: Returning customer data: segment={}, preferences={}&quot;, segment, preferences);&#10;        return data;&#10;    }&#10;&#10;    private String determineSegment(String customerId) {&#10;        int hash = Math.abs(customerId.hashCode());&#10;        return switch (hash % 4) {&#10;            case 0 -&gt; &quot;PREMIUM&quot;;&#10;            case 1 -&gt; &quot;PROFESSIONAL&quot;;&#10;            case 2 -&gt; &quot;DEALER&quot;;&#10;            default -&gt; &quot;STANDARD&quot;;&#10;        };&#10;    }&#10;&#10;    private List&lt;String&gt; determinePreferences(String customerId) {&#10;        int hash = Math.abs(customerId.hashCode());&#10;        return switch (hash % 3) {&#10;            case 0 -&gt; List.of(&quot;HYDRAULICS&quot;, &quot;TRACTORS&quot;, &quot;FAST_DELIVERY&quot;);&#10;            case 1 -&gt; List.of(&quot;FILTERS&quot;, &quot;ENGINES&quot;, &quot;BULK_DISCOUNT&quot;);&#10;            default -&gt; List.of(&quot;PARTS&quot;, &quot;ACCESSORIES&quot;);&#10;        };&#10;    }&#10;&#10;    private void simulateLatency() {&#10;        try {&#10;            Thread.sleep(LATENCY_MS);&#10;        } catch (InterruptedException e) {&#10;            Thread.currentThread().interrupt();&#10;        }&#10;    }&#10;&#10;    private void simulateFailure() {&#10;        if (random.nextDouble() &gt; RELIABILITY) {&#10;            log.warn(&quot;Mock: Simulating customer service failure&quot;);&#10;            throw new RuntimeException(&quot;Simulated customer service failure&quot;);&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/infrastructure/MockPricingService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/com/kramp/productinfo/infrastructure/MockPricingService.java" />
              <option name="updatedContent" value="package com.kramp.productinfo.infrastructure;&#10;&#10;import com.kramp.productinfo.domain.model.ProductInfo.PricingData;&#10;import com.kramp.productinfo.domain.ports.PricingServicePort;&#10;import org.slf4j.Logger;&#10;import org.slf4j.LoggerFactory;&#10;import org.springframework.stereotype.Component;&#10;&#10;import java.math.BigDecimal;&#10;import java.math.RoundingMode;&#10;import java.util.Random;&#10;&#10;@Component&#10;public class MockPricingService implements PricingServicePort {&#10;&#10;    private static final Logger log = LoggerFactory.getLogger(MockPricingService.class);&#10;    private static final Random random = new Random();&#10;    private static final double RELIABILITY = 0.995; // 99.5%&#10;    private static final int LATENCY_MS = 80;&#10;&#10;    @Override&#10;    public PricingData getPricingData(String productId, String market, String customerId) {&#10;        simulateLatency();&#10;        simulateFailure();&#10;&#10;        log.debug(&quot;Mock: Fetching pricing data for productId={}, market={}, customerId={}&quot;,&#10;                productId, market, customerId);&#10;&#10;        String currency = getCurrency(market);&#10;        BigDecimal basePrice = calculateBasePrice(productId, currency);&#10;        BigDecimal customerDiscount = calculateDiscount(customerId);&#10;        BigDecimal finalPrice = basePrice.multiply(BigDecimal.ONE.subtract(customerDiscount))&#10;                .setScale(2, RoundingMode.HALF_UP);&#10;&#10;        PricingData data = new PricingData(basePrice, customerDiscount, finalPrice, currency, true);&#10;        log.debug(&quot;Mock: Returning pricing data: basePrice={}, finalPrice={}, currency={}&quot;,&#10;                basePrice, finalPrice, currency);&#10;        return data;&#10;    }&#10;&#10;    private BigDecimal calculateBasePrice(String productId, String currency) {&#10;        // Generate deterministic price based on productId hash&#10;        int hash = Math.abs(productId.hashCode());&#10;        double price = 100 + (hash % 900); // Price between 100 and 1000&#10;&#10;        // Adjust for currency&#10;        return switch (currency) {&#10;            case &quot;PLN&quot; -&gt; BigDecimal.valueOf(price * 4.5);&#10;            case &quot;GBP&quot; -&gt; BigDecimal.valueOf(price * 0.85);&#10;            case &quot;DKK&quot; -&gt; BigDecimal.valueOf(price * 7.5);&#10;            case &quot;SEK&quot; -&gt; BigDecimal.valueOf(price * 10.5);&#10;            default -&gt; BigDecimal.valueOf(price); // EUR&#10;        };&#10;    }&#10;&#10;    private BigDecimal calculateDiscount(String customerId) {&#10;        if (customerId == null || customerId.isBlank()) {&#10;            return BigDecimal.ZERO;&#10;        }&#10;&#10;        // Generate discount based on customerId (0% to 25%)&#10;        int hash = Math.abs(customerId.hashCode());&#10;        double discount = (hash % 26) / 100.0;&#10;        return BigDecimal.valueOf(discount);&#10;    }&#10;&#10;    private String getCurrency(String market) {&#10;        return switch (market.substring(0, 2).toLowerCase()) {&#10;            case &quot;nl&quot;, &quot;de&quot;, &quot;fr&quot;, &quot;it&quot;, &quot;es&quot;, &quot;pt&quot; -&gt; &quot;EUR&quot;;&#10;            case &quot;pl&quot; -&gt; &quot;PLN&quot;;&#10;            case &quot;gb&quot; -&gt; &quot;GBP&quot;;&#10;            case &quot;dk&quot; -&gt; &quot;DKK&quot;;&#10;            case &quot;se&quot; -&gt; &quot;SEK&quot;;&#10;            default -&gt; &quot;EUR&quot;;&#10;        };&#10;    }&#10;&#10;    private void simulateLatency() {&#10;        try {&#10;            Thread.sleep(LATENCY_MS);&#10;        } catch (InterruptedException e) {&#10;            Thread.currentThread().interrupt();&#10;        }&#10;    }&#10;&#10;    private void simulateFailure() {&#10;        if (random.nextDouble() &gt; RELIABILITY) {&#10;            log.warn(&quot;Mock: Simulating pricing service failure&quot;);&#10;            throw new RuntimeException(&quot;Simulated pricing service failure&quot;);&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>